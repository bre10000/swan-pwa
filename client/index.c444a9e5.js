import{S as e,i as t,s as a,e as s,t as r,c as l,a as o,b as i,d as c,f as n,h as d,j as u,k as m,I as h,l as p,m as f,n as _,p as b,q as g,r as y,v as $,w,x as k,y as v,z as E,A as D,B as x,C as P,D as A,E as V,F as B,G as R,H as I,J as N,u as S,g as W,o as C,K as T,L as F,M as j,N as M}from"./client.39550401.js";import{l as U}from"./index.79acf2d4.js";import{D as H}from"./DeleteConfirmation.21dd4a11.js";import{D as O}from"./DataTableDetails.0585d28a.js";import{e as q}from"./csvGenerator.56fc5e7e.js";import{e as L}from"./exportPDFAlternate.b140167e.js";import{c as G}from"./log.007d9b48.js";import"./SelectedColumns.d22c9ba9.js";import"./SelectedColumns.61150ba7.js";import"./jspdf.plugin.autotable.dc15019a.js";function Y(e){let t,a,h=e[3].total+"";return{c(){t=s("span"),a=r(h),this.h()},l(e){t=l(e,"SPAN",{class:!0});var s=o(t);a=i(s,h),s.forEach(c),this.h()},h(){n(t,"class","gray has-text-weight-light ml-2")},m(e,s){d(e,t,s),u(t,a)},p(e,t){8&t&&h!==(h=e[3].total+"")&&m(a,h)},d(e){e&&c(t)}}}function z(e){let t,a,m,p,_,D,x,A,V,B,R,I,N,S,W,C;return x=new h({props:{data:f,scale:"3"}}),{c(){t=s("div"),a=s("br"),m=s("br"),p=s("br"),_=s("br"),D=E(),b(x.$$.fragment),A=E(),V=s("p"),B=r("Uh oh! nothing found on database."),R=E(),I=s("br"),N=s("br"),S=s("br"),W=s("br"),this.h()},l(e){t=l(e,"DIV",{class:!0});var s=o(t);a=l(s,"BR",{}),m=l(s,"BR",{}),p=l(s,"BR",{}),_=l(s,"BR",{}),D=P(s),g(x.$$.fragment,s),A=P(s),V=l(s,"P",{class:!0});var r=o(V);B=i(r,"Uh oh! nothing found on database."),r.forEach(c),R=P(s),I=l(s,"BR",{}),N=l(s,"BR",{}),S=l(s,"BR",{}),W=l(s,"BR",{}),s.forEach(c),this.h()},h(){n(V,"class","gray"),n(t,"class","has-text-centered")},m(e,s){d(e,t,s),u(t,a),u(t,m),u(t,p),u(t,_),u(t,D),y(x,t,null),u(t,A),u(t,V),u(V,B),u(t,R),u(t,I),u(t,N),u(t,S),u(t,W),C=!0},p:$,i(e){C||(w(x.$$.fragment,e),C=!0)},o(e){k(x.$$.fragment,e),C=!1},d(e){e&&c(t),v(x)}}}function J(e){let t,a;return t=new O({props:{pagination:e[3],columns:e[4],columnsDetails:e[5],detailVariable:X,rows:e[2],options:e[6]}}),t.$on("clickCol",e[9]),t.$on("changePage",e[8]),t.$on("deleteRow",e[12]),t.$on("editRow",e[10]),t.$on("clickRow",e[10]),t.$on("printRow",e[11]),{c(){b(t.$$.fragment)},l(e){g(t.$$.fragment,e)},m(e,s){y(t,e,s),a=!0},p(e,a){const s={};8&a&&(s.pagination=e[3]),4&a&&(s.rows=e[2]),t.$set(s)},i(e){a||(w(t.$$.fragment,e),a=!0)},o(e){k(t.$$.fragment,e),a=!1},d(e){v(t,e)}}}function K(e){let t,a;return t=new H({}),t.$on("confirm",e[13]),t.$on("dismiss",e[19]),{c(){b(t.$$.fragment)},l(e){g(t.$$.fragment,e)},m(e,s){y(t,e,s),a=!0},p:$,i(e){a||(w(t.$$.fragment,e),a=!0)},o(e){k(t.$$.fragment,e),a=!1},d(e){v(t,e)}}}function Q(e){let t,a,m,$,S,W,C,T,j,M,U,H,O,q,L,G,Q,X,Z,ee,te,ae,se,re,le,oe,ie,ce,ne,de,ue,me,he,pe,fe,_e,be,ge,ye,$e,we,ke,ve,Ee,De,xe,Pe,Ae,Ve,Be,Re,Ie,Ne,Se,We,Ce,Te,Fe,je,Me,Ue,He,Oe,qe,Le,Ge,Ye,ze,Je,Ke,Qe,Xe=e[3]&&Y(e);q=new h({props:{data:p}}),oe=new h({props:{data:f}}),$e=new h({props:{data:_}});const Ze=[J,z],et=[];function tt(e,t){return e[2]?.length>0?0:1}je=tt(e),Me=et[je]=Ze[je](e);let at=e[1]&&K(e);return{c(){t=E(),a=s("br"),m=s("br"),$=E(),S=s("div"),W=s("div"),C=s("div"),T=s("h3"),j=r("Waybills\r\n                "),Xe&&Xe.c(),M=E(),U=s("div"),H=s("a"),O=s("span"),b(q.$$.fragment),L=E(),G=s("span"),Q=r("Add a Waybill"),X=E(),Z=s("div"),ee=s("div"),te=s("div"),ae=s("div"),se=s("input"),re=E(),le=s("span"),b(oe.$$.fragment),ie=E(),ce=s("div"),ne=s("button"),de=r("Search"),ue=E(),me=s("div"),he=s("div"),pe=s("div"),fe=s("button"),_e=s("span"),be=r("Export To Excel or PDF"),ge=E(),ye=s("span"),b($e.$$.fragment),we=E(),ke=s("div"),ve=s("div"),Ee=s("a"),De=r("Export Current Page to Excel"),xe=E(),Pe=s("a"),Ae=r("Export Current Page to PDF"),Ve=E(),Be=s("hr"),Re=E(),Ie=s("a"),Ne=r("Export All to Excel"),Se=E(),We=s("a"),Ce=r("Export All to PDF"),Te=E(),Fe=s("div"),Me.c(),Ue=E(),He=s("br"),Oe=s("br"),qe=s("br"),Le=s("br"),Ge=s("br"),Ye=E(),at&&at.c(),ze=D(),this.h()},l(e){x('[data-svelte="svelte-ar7m8s"]',document.head).forEach(c),t=P(e),a=l(e,"BR",{}),m=l(e,"BR",{}),$=P(e),S=l(e,"DIV",{class:!0});var s=o(S);W=l(s,"DIV",{class:!0});var r=o(W);C=l(r,"DIV",{class:!0});var n=o(C);T=l(n,"H3",{});var d=o(T);j=i(d,"Waybills\r\n                "),Xe&&Xe.l(d),d.forEach(c),n.forEach(c),M=P(r),U=l(r,"DIV",{class:!0});var u=o(U);H=l(u,"A",{href:!0,class:!0});var h=o(H);O=l(h,"SPAN",{class:!0});var p=o(O);g(q.$$.fragment,p),p.forEach(c),L=P(h),G=l(h,"SPAN",{class:!0});var f=o(G);Q=i(f,"Add a Waybill"),f.forEach(c),h.forEach(c),u.forEach(c),r.forEach(c),X=P(s),Z=l(s,"DIV",{class:!0});var _=o(Z);ee=l(_,"DIV",{class:!0});var b=o(ee);te=l(b,"DIV",{class:!0,style:!0});var y=o(te);ae=l(y,"DIV",{class:!0});var w=o(ae);se=l(w,"INPUT",{class:!0,type:!0,placeholder:!0}),re=P(w),le=l(w,"SPAN",{class:!0});var k=o(le);g(oe.$$.fragment,k),k.forEach(c),w.forEach(c),ie=P(y),ce=l(y,"DIV",{class:!0});var v=o(ce);ne=l(v,"BUTTON",{class:!0});var E=o(ne);de=i(E,"Search"),E.forEach(c),v.forEach(c),y.forEach(c),b.forEach(c),ue=P(_),me=l(_,"DIV",{class:!0});var A=o(me);he=l(A,"DIV",{class:!0});var V=o(he);pe=l(V,"DIV",{class:!0});var B=o(pe);fe=l(B,"BUTTON",{class:!0,"aria-haspopup":!0,"aria-controls":!0});var R=o(fe);_e=l(R,"SPAN",{});var I=o(_e);be=i(I,"Export To Excel or PDF"),I.forEach(c),ge=P(R),ye=l(R,"SPAN",{class:!0});var N=o(ye);g($e.$$.fragment,N),N.forEach(c),R.forEach(c),B.forEach(c),we=P(V),ke=l(V,"DIV",{class:!0,id:!0,role:!0});var F=o(ke);ve=l(F,"DIV",{class:!0});var Y=o(ve);Ee=l(Y,"A",{href:!0,class:!0});var z=o(Ee);De=i(z,"Export Current Page to Excel"),z.forEach(c),xe=P(Y),Pe=l(Y,"A",{href:!0,class:!0});var J=o(Pe);Ae=i(J,"Export Current Page to PDF"),J.forEach(c),Ve=P(Y),Be=l(Y,"HR",{class:!0}),Re=P(Y),Ie=l(Y,"A",{href:!0,class:!0});var K=o(Ie);Ne=i(K,"Export All to Excel"),K.forEach(c),Se=P(Y),We=l(Y,"A",{href:!0,class:!0});var je=o(We);Ce=i(je,"Export All to PDF"),je.forEach(c),Y.forEach(c),F.forEach(c),V.forEach(c),A.forEach(c),_.forEach(c),Te=P(s),Fe=l(s,"DIV",{class:!0});var Je=o(Fe);Me.l(Je),Je.forEach(c),Ue=P(s),He=l(s,"BR",{}),Oe=l(s,"BR",{}),qe=l(s,"BR",{}),Le=l(s,"BR",{}),Ge=l(s,"BR",{}),s.forEach(c),Ye=P(e),at&&at.l(e),ze=D(),this.h()},h(){document.title="Waybills",n(C,"class","column"),n(O,"class","icon"),n(G,"class","has-text-white has-text-weight-bold"),n(H,"href","/waybills/add"),n(H,"class","button is-dark px-5"),n(U,"class","column has-text-right"),n(W,"class","columns"),n(se,"class","input is-dark"),n(se,"type","search"),n(se,"placeholder","search"),n(le,"class","icon is-small is-left"),n(ae,"class","control has-icons-left"),n(ne,"class","button is-dark has-text-weight-bold"),n(ce,"class","control"),n(te,"class","field has-addons"),A(te,"width","500px"),n(ee,"class","column"),n(ye,"class","icon is-small"),n(fe,"class","button"),n(fe,"aria-haspopup","true"),n(fe,"aria-controls","dropdown-menu"),n(pe,"class","dropdown-trigger"),n(Ee,"href","#"),n(Ee,"class","dropdown-item"),n(Pe,"href","#"),n(Pe,"class","dropdown-item"),n(Be,"class","dropdown-divider"),n(Ie,"href","#"),n(Ie,"class","dropdown-item"),n(We,"href","#"),n(We,"class","dropdown-item"),n(ve,"class","dropdown-content has-text-left"),n(ke,"class","dropdown-menu"),n(ke,"id","dropdown-menu"),n(ke,"role","menu"),n(he,"class","dropdown is-hoverable"),n(me,"class","column has-text-right"),n(Z,"class","columns"),n(Fe,"class","card"),n(S,"class","container px-6")},m(s,r){d(s,t,r),d(s,a,r),d(s,m,r),d(s,$,r),d(s,S,r),u(S,W),u(W,C),u(C,T),u(T,j),Xe&&Xe.m(T,null),u(W,M),u(W,U),u(U,H),u(H,O),y(q,O,null),u(H,L),u(H,G),u(G,Q),u(S,X),u(S,Z),u(Z,ee),u(ee,te),u(te,ae),u(ae,se),V(se,e[0]),u(ae,re),u(ae,le),y(oe,le,null),u(te,ie),u(te,ce),u(ce,ne),u(ne,de),u(Z,ue),u(Z,me),u(me,he),u(he,pe),u(pe,fe),u(fe,_e),u(_e,be),u(fe,ge),u(fe,ye),y($e,ye,null),u(he,we),u(he,ke),u(ke,ve),u(ve,Ee),u(Ee,De),u(ve,xe),u(ve,Pe),u(Pe,Ae),u(ve,Ve),u(ve,Be),u(ve,Re),u(ve,Ie),u(Ie,Ne),u(ve,Se),u(ve,We),u(We,Ce),u(S,Te),u(S,Fe),et[je].m(Fe,null),u(S,Ue),u(S,He),u(S,Oe),u(S,qe),u(S,Le),u(S,Ge),d(s,Ye,r),at&&at.m(s,r),d(s,ze,r),Je=!0,Ke||(Qe=[B(se,"input",e[18]),B(ne,"click",e[7]),B(Ee,"click",R(e[14])),B(Pe,"click",R(e[15])),B(Ie,"click",R(e[16])),B(We,"click",R(e[17]))],Ke=!0)},p(e,[t]){e[3]?Xe?Xe.p(e,t):(Xe=Y(e),Xe.c(),Xe.m(T,null)):Xe&&(Xe.d(1),Xe=null),1&t&&V(se,e[0]);let a=je;je=tt(e),je===a?et[je].p(e,t):(F(),k(et[a],1,1,(()=>{et[a]=null})),I(),Me=et[je],Me?Me.p(e,t):(Me=et[je]=Ze[je](e),Me.c()),w(Me,1),Me.m(Fe,null)),e[1]?at?(at.p(e,t),2&t&&w(at,1)):(at=K(e),at.c(),w(at,1),at.m(ze.parentNode,ze)):at&&(F(),k(at,1,1,(()=>{at=null})),I())},i(e){Je||(w(q.$$.fragment,e),w(oe.$$.fragment,e),w($e.$$.fragment,e),w(Me),w(at),Je=!0)},o(e){k(q.$$.fragment,e),k(oe.$$.fragment,e),k($e.$$.fragment,e),k(Me),k(at),Je=!1},d(e){e&&c(t),e&&c(a),e&&c(m),e&&c($),e&&c(S),Xe&&Xe.d(),v(q),v(oe),v($e),et[je].d(),e&&c(Ye),at&&at.d(e),e&&c(ze),Ke=!1,N(Qe)}}}let X="waybill_items";function Z(e){let t=[];return e.forEach((e=>{t.push([e.id,e.attributes.destination,e.attributes.consortium_member.data.attributes.name,e.attributes.category,e.attributes.date,"-","-","-","-","-","-","-","-"]),e.attributes.waybill_items.data.forEach((e=>{t.push(["-","-","-","-","-",e.id,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.purchase_order.data.attributes.poNumber,e.attributes.stock_release_item.data.attributes.stock_release.data.id,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.item.data.attributes.name,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.unit,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.pieces,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.currency,e.attributes.stock_release_item.data.attributes.purchase_order_item.data.attributes.unitPrice,e.attributes.stock_release_item.data.attributes.quantity])}))})),t}function ee(e,t,a){const s=S.subscribe((e=>{!e.loggedIn&&e.fetched?W("/login"):e.data&&m()}));C(s);let r,l="",o="",i=!1,c=[];const n=[{key:"id",title:"ID",sortable:!0,filterValue:e=>Math.floor(e.id/10),interval:10,filterType:"numeric",headerClass:"has-text-left",selected:!0},{key:"destination",title:"Destination",sortable:!0,filterValue:e=>e.last_name.charAt(0).toLowerCase(),filterType:"string",selected:!0},{key:"consortium_member",title:"Consortium Member",sortable:!0,filterValue:e=>e.last_name.charAt(0).toLowerCase(),filterType:"string",selected:!0},{key:"category",title:"Category",sortable:!0,filterValue:e=>e.last_name.charAt(0).toLowerCase(),filterType:"string",selected:!0},{key:"date",title:"Date",sortable:!0,filterValue:e=>e.last_name.charAt(0).toLowerCase(),filterType:"string",selected:!0}],d=[{key:"id",title:"ID",sortable:!0,selected:!0},{key:"poNumber",title:"PO#",sortable:!0,selected:!0},{key:"srfNo",title:"SRF No.",sortable:!0,selected:!0},{key:"item",title:"ITEM",sortable:!0,selected:!0},{key:"unit",title:"Unit",sortable:!0,selected:!0},{key:"pieces",title:"Pieces",sortable:!0,selected:!0},{key:"currency",title:"Currency",sortable:!0,selected:!0},{key:"unitPrice",title:"Unit Price",sortable:!0,selected:!0},{key:"quantity",title:"Quantity",sortable:!0,selected:!0}];let u;async function m(e,t,s){try{let r={filters:e||{},sort:t||"id:desc","pagination[page]":s||1,populate:{consortium_member:{populate:"*"},waybill_items:{populate:["stock_release_item","stock_release_item.stock_release","stock_release_item.purchase_order_item","stock_release_item.purchase_order_item.item","stock_release_item.purchase_order_item.purchase_order"]}}};r=U.stringify(r,{encodeValuesOnly:!0});let l=await T("waybills",r);console.log("Get Waybills Request - ",l),a(2,c=l.data),a(3,u=l.meta?.pagination)}catch(e){console.warn("Error Getting Waybills - ",e)}}function h(){m(p(),o)}function p(){return{$or:[{date:{$containsi:l}},{destination:{$containsi:l}},{category:{$containsi:l}},{consortium_member:{name:{$containsi:l}}},{waybill_items:{stock_release_item:{stock_release:{id:{$in:[l]}}}}},{waybill_items:{stock_release_item:{purchase_order_item:{item:{name:{$containsi:l}}}}}},{waybill_items:{stock_release_item:{purchase_order_item:{item:{category:{$containsi:l}}}}}},{waybill_items:{stock_release_item:{purchase_order_item:{unit:{$containsi:l}}}}},{waybill_items:{stock_release_item:{purchase_order_item:{purchase_order:{poNumber:{$containsi:l}}}}}}]}}return[l,i,c,u,n,d,{title:"Waybills Table",showFilterHeader:!1,showSelect:!1,showDetails:!1,showPrint:!0,showActions:!0,showFooter:!1},h,function(e){m(p(),o,e.detail.newPage)},function(e){o=e.detail.key,o=o.replace("consortium_member","consortium_member.name"),o=o.replace("warehouse","warehouse.name"),m(p(),o,e.detail.newPage)},function(e){W("waybills/edit/"+e.detail.row.id)},function(e){W("reports/single/waybill/"+e.detail.row.id)},function(e){r=e.detail.row,a(1,i=!0)},async function(){a(1,i=!1);try{let e=await j("waybills/"+r.id,null);console.log("Delete Waybill Request  ",e),e.data?.id&&(M.push("Waybill Deleted Successfully!",{duration:2e4,theme:{"--toastBackground":"#48BB78","--toastBarBackground":"#2F855A"}}),G("Waybill",r,"Delete",e.data.id),h())}catch(e){console.log("Error Delete Waybill   ",e)}},function(){let e=new Date,t=`"SWAN "Waybills ${e.getFullYear()}-${e.getMonth()}-${e.getDate()} T${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}.csv`,a=Z(c);a=[n.concat(d).map((e=>e.title)),...a],q(t,a)},function(){L("Waybills",Z(c),n.concat(d))},async function(){try{let e={populate:{consortium_member:{populate:"*"},waybill_items:{populate:["stock_release_item","stock_release_item.stock_release","stock_release_item.purchase_order_item","stock_release_item.purchase_order_item.item","stock_release_item.purchase_order_item.purchase_order"]}},"pagination[limit]":-1};e=U.stringify(e,{encodeValuesOnly:!0});let t=await T("waybills",e),a=new Date,s=`"SWAN "Waybills ${a.getFullYear()}-${a.getMonth()}-${a.getDate()} T${a.getHours()}-${a.getMinutes()}-${a.getSeconds()}.csv`,r=Z(t.data);r=[n.concat(d).map((e=>e.title)),...r],q(s,r)}catch(e){}},async function(){try{let e={"pagination[limit]":-1,populate:{consortium_member:{populate:"*"},waybill_items:{populate:["stock_release_item","stock_release_item.stock_release","stock_release_item.purchase_order_item","stock_release_item.purchase_order_item.item","stock_release_item.purchase_order_item.purchase_order"]}}};e=U.stringify(e,{encodeValuesOnly:!0});let t=await T("waybills",e);L("Waybills",Z(t.data),n.concat(d))}catch(e){}},function(){l=this.value,a(0,l)},()=>a(1,i=!1)]}class te extends e{constructor(e){super(),t(this,e,ee,Q,a,{})}}export{te as default};
